<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.60">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/logo.svg"><title>最牛的Linux Shell命令 | ubuntu 简明指南</title><meta name="description" content="使用 ubuntu 作为日常 工作 🧑🏻‍💻 娱乐 🍿 的系统">
    <link rel="preload" href="/ubuntu-workstation-guide/assets/style-89f3362e.css" as="style"><link rel="stylesheet" href="/ubuntu-workstation-guide/assets/style-89f3362e.css">
    <link rel="modulepreload" href="/ubuntu-workstation-guide/assets/app-8c5101d9.js"><link rel="modulepreload" href="/ubuntu-workstation-guide/assets/framework-96b046e1.js"><link rel="modulepreload" href="/ubuntu-workstation-guide/assets/top_linux_commands.html-605aa0cd.js"><link rel="modulepreload" href="/ubuntu-workstation-guide/assets/top_linux_commands.html-acfa17d2.js"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-3dda6469.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-be6e4973.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-3786e680.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-8134f832.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/github.html-c8282ab5.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/pan.html-35983381.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/recommend.html-a36a8fd4.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/resourse.html-735e861d.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/deep-learning.html-4a77920d.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/cuda.html-a192f550.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/go.html-4b635882.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/java.html-40cc114a.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/node.html-0accc4d4.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/python.html-8b32aec4.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/download.html-d59a3985.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/env.html-1708e031.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/docker.html-727a90f5.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/elasticsearch.html-f6d82b77.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/hbase.html-893b92c6.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/kafka.html-1cc0752d.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/mongodb.html-e1aa82e6.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/mysql.html-e9199d8d.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/nginx.html-e60c920a.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/rabbitmq.html-ddec674f.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/redis.html-8a1f34b6.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/rocketmq.html-86d00fcc.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/tomcat.html-38655f5c.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/zookeeper.html-4fc43176.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/amusement.html-cc90c1fd.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/code.html-773c3acf.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/communication.html-b45a16a5.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/daily.html-ca3e0c8c.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/how.html-9e4c72d9.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/office.html-b2d3b8e6.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/source.html-bef1ee19.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/directory.html-2edece0b.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/linux.html-8a8a2190.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/ubuntu.html-46d9eaa8.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/distribution.html-a81d14c2.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/driver.html-7fee9f1c.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/hardware.html-0c1b9806.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/media-and-setting.html-4438a606.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/native.html-46737d54.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/virtual.html-ad41a600.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-461f6c25.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/need.html-aebb7868.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/wiki.html-5eb55a4f.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/advanced.html-2b62995e.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/basic.html-98d17762.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/beauty.html-a0c9d51b.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/network.html-5a090313.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-5a808609.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-f853217b.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-c52eea7c.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-c4c1915d.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/github.html-92f58733.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/pan.html-356e3c32.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/recommend.html-e480c32b.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/resourse.html-eef3b402.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/deep-learning.html-f7eae5f4.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/cuda.html-977bc8dd.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/go.html-e06d6732.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/java.html-15cd4faa.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/node.html-0a850db7.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/python.html-3eda4400.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/download.html-77ec3ddb.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/env.html-b9ce54bf.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/docker.html-1af2635c.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/elasticsearch.html-f92577a1.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/hbase.html-7a5dec18.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/kafka.html-7ea05091.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/mongodb.html-7a0b16d5.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/mysql.html-8daa5fe6.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/nginx.html-ed56a6d5.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/rabbitmq.html-59d206d6.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/redis.html-aca8d25b.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/rocketmq.html-f86f84da.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/tomcat.html-b4c8ba9a.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/zookeeper.html-88ed7ea5.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/amusement.html-136b16cc.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/code.html-e7849d5c.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/communication.html-79511edd.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/daily.html-32dec81d.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/how.html-c802d265.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/office.html-bb9ba921.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/source.html-6a811090.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/directory.html-f8d98a1f.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/linux.html-4029c115.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/ubuntu.html-6119fed3.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/distribution.html-8f476520.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/driver.html-f8110245.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/hardware.html-37763165.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/media-and-setting.html-47ffe522.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/native.html-91959b20.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/virtual.html-d34cfaff.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/index.html-26c8acfa.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/need.html-5ddb3c37.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/wiki.html-f5748a8c.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/advanced.html-40b9449e.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/basic.html-e1976ea5.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/beauty.html-cab66bbc.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/network.html-70e15d64.js" as="script"><link rel="prefetch" href="/ubuntu-workstation-guide/assets/404.html-46166703.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/ubuntu-workstation-guide/" class=""><img class="logo" src="/ubuntu-workstation-guide/images/logo.svg" alt="ubuntu 简明指南"><span class="site-name can-hide">ubuntu 简明指南</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/ubuntu-workstation-guide/guide/" class="" aria-label="开始使用 👏"><!--[--><!--]--> 开始使用 👏 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/ubuntu-workstation-guide/code/" class="" aria-label="开发相关 💻"><!--[--><!--]--> 开发相关 💻 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/ubuntu-workstation-guide/tip/" class="router-link-active" aria-label="推荐内容 🪁"><!--[--><!--]--> 推荐内容 🪁 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/emerywan/ubuntu-workstation-guide" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/ubuntu-workstation-guide/guide/" class="" aria-label="开始使用 👏"><!--[--><!--]--> 开始使用 👏 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/ubuntu-workstation-guide/code/" class="" aria-label="开发相关 💻"><!--[--><!--]--> 开发相关 💻 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/ubuntu-workstation-guide/tip/" class="router-link-active" aria-label="推荐内容 🪁"><!--[--><!--]--> 推荐内容 🪁 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/emerywan/ubuntu-workstation-guide" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">推荐 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/ubuntu-workstation-guide/tip/recommend.html" class="sidebar-item" aria-label="一些推荐"><!--[--><!--]--> 一些推荐 <!--[--><!--]--></a><!----></li><li><a href="/ubuntu-workstation-guide/tip/github.html" class="sidebar-item" aria-label="Github 国内加速"><!--[--><!--]--> Github 国内加速 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="最牛的Linux Shell命令"><!--[--><!--]--> 最牛的Linux Shell命令 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#引言" class="router-link-active router-link-exact-active sidebar-item" aria-label="引言"><!--[--><!--]--> 引言 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_1-以sudo运行上条命令" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.以sudo运行上条命令"><!--[--><!--]--> 1.以sudo运行上条命令 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_2-以http方式共享当前文件夹的文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.以HTTP方式共享当前文件夹的文件"><!--[--><!--]--> 2.以HTTP方式共享当前文件夹的文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_3-在以普通用户打开的vim当中保存一个root用户文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.在以普通用户打开的vim当中保存一个root用户文件"><!--[--><!--]--> 3.在以普通用户打开的vim当中保存一个root用户文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_4-切换回上一个目录" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.切换回上一个目录"><!--[--><!--]--> 4.切换回上一个目录 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_5-替换上一条命令中的一个短语" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.替换上一条命令中的一个短语"><!--[--><!--]--> 5.替换上一条命令中的一个短语 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_6-快速备份一个文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.快速备份一个文件"><!--[--><!--]--> 6.快速备份一个文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_7-免密码ssh登录主机" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.免密码ssh登录主机"><!--[--><!--]--> 7.免密码ssh登录主机 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_8-抓取linux桌面的视频" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.抓取Linux桌面的视频"><!--[--><!--]--> 8.抓取Linux桌面的视频 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_1-用你最喜欢的编辑器来敲命令" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.用你最喜欢的编辑器来敲命令"><!--[--><!--]--> 1.用你最喜欢的编辑器来敲命令 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_2-清空或创建一个文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.清空或创建一个文件"><!--[--><!--]--> 2.清空或创建一个文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_3-用ssh创建端口转发通道" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.用ssh创建端口转发通道"><!--[--><!--]--> 3.用ssh创建端口转发通道 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_4-重置终端" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.重置终端"><!--[--><!--]--> 4.重置终端 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_5-在午夜的时候执行某命令" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.在午夜的时候执行某命令"><!--[--><!--]--> 5.在午夜的时候执行某命令 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_6-远程传送麦克风语音" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.远程传送麦克风语音"><!--[--><!--]--> 6.远程传送麦克风语音 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_7-映射一个内存目录" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.映射一个内存目录"><!--[--><!--]--> 7.映射一个内存目录 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_8-用diff对比远程文件跟本地文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.用diff对比远程文件跟本地文件"><!--[--><!--]--> 8.用diff对比远程文件跟本地文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/ubuntu-workstation-guide/tip/top_linux_commands.html#_9-查看系统中占用端口的进程" class="router-link-active router-link-exact-active sidebar-item" aria-label="9.查看系统中占用端口的进程"><!--[--><!--]--> 9.查看系统中占用端口的进程 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/ubuntu-workstation-guide/tip/resourse.html" class="sidebar-item" aria-label="130个资源网站，总有一个你用得着"><!--[--><!--]--> 130个资源网站，总有一个你用得着 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">玩法 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/ubuntu-workstation-guide/tip/pan.html" class="sidebar-item" aria-label="搭建局域网盘"><!--[--><!--]--> 搭建局域网盘 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><div class="language-text" data-ext="text"><pre class="language-text"><code> _____________________
&lt; 最牛的Linux Shell命令 &gt;
 ---------------------
        \   ^__^
         \  (..)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
</code></pre></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>本文内容来自于：<a href="https://plantegg.github.io/2017/01/01/top_linux_commands/" target="_blank" rel="noopener noreferrer">https://plantegg.github.io/2017/01/01/top_linux_commands/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><h2 id="引言" tabindex="-1"><a class="header-anchor" href="#引言" aria-hidden="true">#</a> 引言</h2><p>Shell作为Unix系操作系统当中最有魅力且不可或缺的组件，经过数十载的洗礼不仅没有被淘汰，而且愈加变得成熟稳健，究其原因，大概因为它是个非常稳固的粘合剂，能够把大量功能强大的组件任意配搭，总能很好很快地完成用户的任务。</p><p>本文的一些命令很可能看起来是“雕虫小技”，我们只好仰慕一下Shell大牛了，但是有些细节我会稍加发掘加以说明，遇到有趣的地方希望能博您一笑了。</p><h2 id="_1-以sudo运行上条命令" tabindex="-1"><a class="header-anchor" href="#_1-以sudo运行上条命令" aria-hidden="true">#</a> 1.以sudo运行上条命令</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token operator">!</span><span class="token operator">!</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>大家应该都知sudo，不解释。但通常出现的情况是，敲完命令执行后报错才发现忘了sudo。这时候，新手用户就会：按上箭头，按左箭头，盯着光标回到开始处，输入sudo，回车；高手用户就蛋定多了，按Ctrl-p，按Ctrl-a，输入sudo，回车。</p><p>这里介绍这个是天外飞仙级别的，对，就直接 <code>sudo !!</code>。</p><p>当然这几种解决方式效果是完全一样的，只是款不一样，嗯，不解释。</p><p>两个感叹号其实是bash的一个特性，称为事件引用符（event designators）。!!其实相当于!-1，引用前一条命令，当然也可以!-2，!-50。默认情况下bash会在~/.bash_history文件内记录用户执行的最近500条命令，history命令可以显示这些命令。</p><p>关于事件引用符的更多用法可以深入阅读<a href="http://www.catonmat.net/blog/the-definitive-guide-to-bash-command-line-history/" target="_blank" rel="noopener noreferrer">The Definitive Guide to Bash Command Line History<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h2 id="_2-以http方式共享当前文件夹的文件" tabindex="-1"><a class="header-anchor" href="#_2-以http方式共享当前文件夹的文件" aria-hidden="true">#</a> 2.以HTTP方式共享当前文件夹的文件</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ python <span class="token parameter variable">-m</span>  SimpleHTTPServer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这命令启动了Python的SimpleHTTPServer模块，考虑到Python在绝大多数的Linux发行版当中都默认安装，所以这个命令很可能是最简单的跨平台传文件的方法。</p><p>命令执行后将在本机8000端口开放HTTP服务，在其他能访问本机的机器的浏览器打开ttp://ip:8000即打开一个目录列表，点击即可下载。</p><h2 id="_3-在以普通用户打开的vim当中保存一个root用户文件" tabindex="-1"><a class="header-anchor" href="#_3-在以普通用户打开的vim当中保存一个root用户文件" aria-hidden="true">#</a> 3.在以普通用户打开的vim当中保存一个root用户文件</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>:w <span class="token operator">!</span>sudo <span class="token function">tee</span> %
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这题目读起来纠结，其实是很常见的，常常忘记了sudo就直接用vim编辑/etc内的文件，（不过也不一定，vim发现保存的文件无法保存时候会提示）等编辑好了，保存时候才发现没权限。曲线方法是先保存个临时文件，退出后再sudo cp回去。不过实际上在vim里面可以直接完成这个过程的，命令就是如此。</p><p>查阅vim的文档（输入:help :w），会提到命令:w!{cmd}，让vim执行一个外部命令{cmd}，然后把当前缓冲区的内容从stdin传入。</p><p>tee是一个把stdin保存到文件的小工具。</p><p>而%，是vim当中一个只读寄存器的名字，总保存着当前编辑文件的文件路径。</p><p>所以执行这个命令，就相当于从vim外部修改了当前编辑的文件，好完工。</p><h2 id="_4-切换回上一个目录" tabindex="-1"><a class="header-anchor" href="#_4-切换回上一个目录" aria-hidden="true">#</a> 4.切换回上一个目录</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token builtin class-name">cd</span> -
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>应该不少人都知道这个，横杆-代表上一个目录的路径。</p><p>实际上cd -就是cd $OLDPWD的简写，bash的固定变量$OLDPWD总保存着之前一个目录的路径。</p><p>相对地，$PWD总保存着当前目录的路径。这些变量在编写shell脚本时候相当有用。</p><h2 id="_5-替换上一条命令中的一个短语" tabindex="-1"><a class="header-anchor" href="#_5-替换上一条命令中的一个短语" aria-hidden="true">#</a> 5.替换上一条命令中的一个短语</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ ^foo^bar^
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>又是另外一个事件引用符（event designator），可以把上一条命令当中的foo替换成bar。</p><p>在需要重复运行调试一道长长的命令，需要测试某个参数时候，用这个命令会比较实用；但多数人会首先选择按上箭头提出上道命令，再移动光标去修改某参数，这样更直观，但效率上就不够使用引用符高，而且在脚本中用这个方法可以简化很多。</p><p>这道命令的原始样式应该是这样的:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">!</span><span class="token operator">!</span>:s/foo/bar/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>本文一开始介绍过!!，后面的一段大家应该很熟悉，vim、sed的替换操作都是这样的语法。</p><p>关于事件引用符的更多用法可以深入阅读<a href="http://www.catonmat.net/blog/the-definitive-guide-to-bash-command-line-history/" target="_blank" rel="noopener noreferrer">The Definitive Guide to Bash Command Line History<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_6-快速备份一个文件" tabindex="-1"><a class="header-anchor" href="#_6-快速备份一个文件" aria-hidden="true">#</a> 6.快速备份一个文件</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">cp</span> filename<span class="token punctuation">{</span>,.bak<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这道命令把filename文件拷贝成filename.bak，大家应该在一些比较复杂的安装教程里面见过这样的用法。其原理就在于bash对大括号的展开操作，filename{,.bak}这一段会被展开成filename filename.bak再传给cp，于是就有了备份的命令了。</p><p>大括号在bash里面是一个排列的意义，可以试试这个：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> <span class="token punctuation">{</span>a,b,c<span class="token punctuation">}</span><span class="token punctuation">{</span>a,b,c<span class="token punctuation">}</span><span class="token punctuation">{</span>a,b,c<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将输出三个集合的全排列:</p><p>aaa aab aac aba abb abc aca acb acc</p><p>baa bab bac bba bbb bbc bca bcb bcc</p><p>caa cab cac cba cbb cbc cca ccb ccc</p><p>关于shell当中的集合操作，可深入阅读<a href="http://www.catonmat.net/blog/set-operations-in-unix-shell/" target="_blank" rel="noopener noreferrer">“Set Operations in the Unix Shell”<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_7-免密码ssh登录主机" tabindex="-1"><a class="header-anchor" href="#_7-免密码ssh登录主机" aria-hidden="true">#</a> 7.免密码ssh登录主机</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ssh-copy-id remote-machine
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这个命令把当前用户的公钥串写入到远程主机的~/.ssh/authorized_keys内，这样下次使用ssh登录的时候，远程主机就直接根据这串密钥完成身份校验，不再询问密码了。前提是你当前用户有生成了公钥，默认是没有的，先执行ssh-keygen试试吧！</p><p>这个命令如果用手工完成，是这样的：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ scp ~/.ssh/identity.pub remote-machine: your-machine$ ssh remote-machine remote-machine$ cat identity.pub &gt;&gt; ~/.ssh/authorized_keys
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果你想删掉远程主机上的密钥，直接打开authorized_keys，搜索你的用户名，删除那行，即可。</p><h2 id="_8-抓取linux桌面的视频" tabindex="-1"><a class="header-anchor" href="#_8-抓取linux桌面的视频" aria-hidden="true">#</a> 8.抓取Linux桌面的视频</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ ffmpeg -f x11grab -s wxga -r 25 -i :0.0 -sameq /tmp/out.mpg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>我们在一些视频网站上看到别人的3D桌面怎么怎么酷的视频，通常就是这么来的，ffmpeg可以直接解码X11的图形，并转换到相应输出格式。</p><p>ffmpeg的通常用法是，根据一堆参数，输出一个文件，输出文件通常放最后，下面解析下几个参数：</p><p>-f x11grab 指定输入类型。因为x11的缓冲区不是普通的视频文件可以侦测格式，必须指定后ffmpeg才知道如何获得输入。</p><p>-s wxga 设置抓取区域的大小。wxga是1366*768的标准说法，也可以换成-s 800×600的写法。</p><p>-r 25 设置帧率，即每秒抓取的画面数。</p><p>-i :0.0 设置输入源，本地X默认在0.0</p><p>-sameq 保持跟输入流一样的图像质量，以用来后期处理。</p><p>至于其他ffmpeg的用法，可以参考下面两篇文章：</p><p>· <a href="http://www.catonmat.net/blog/how-to-extract-audio-tracks-from-youtube-videos/" target="_blank" rel="noopener noreferrer">How to Extract Audio Tracks from YouTube Videos<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>· <a href="http://www.catonmat.net/blog/converting-youtube-flvs-to-a-better-format-with-ffmpeg" target="_blank" rel="noopener noreferrer">Converting YouTube Flash Videos to a Better Format with ffmpeg<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>后记</p><p>说Shell是一种编程语言，可能有些尴尬，虽然很多人每天都在用Shell，但从来没见它荣登TIOBE编程语言排行榜之类的，可以说毫无名分，因为很多用户没意识到它是一种语言，只当做这是一个能够很好完成任务的工具，基本得理所当然，就好像GUI程序的菜单、按钮一样。</p><p>掌握Shell，通常能够让任务在数秒钟内完成，这就让Shell跟C、Perl、Python这些语言区别开来，没人否认后者更能胜任更多的任务，但是他们是在不同的层面上去做，Shell依赖大量的系统组件黏合调用，而后者依赖各种库，各所擅长不同的应用领域，比喻就是，Shell是混凝土，可以很方便地粘合一些建筑组件而成为稳固的高楼大厦；但同样是粘合剂，粘玻璃窗、粘书报、粘皮鞋，混凝土是绝对不合适的，Shell并不擅长一些细致操作，比如它连浮点运算都不支持，更别提什么图形运算什么的。但这并不妨碍Shell来帮我们完成很多粗重任务。</p><p>Shell的工作方式，大多数入门用户会觉得枯燥难学，而所谓的经典教材也离不开《Advanced Bash-Scripting》、《Bash Guide for Beginners》，但类似本文这样的一些“雕虫小技”因为难登大雅之堂绝不会收录进去。这情况如果象国外一些unix用户比较多的地方会有很好改善，即使是新手，偶尔看看别人的操作都能“偷师”一手，我编译本系列文章其实也就希望稍微改善一下这个状况。</p><h2 id="_1-用你最喜欢的编辑器来敲命令" tabindex="-1"><a class="header-anchor" href="#_1-用你最喜欢的编辑器来敲命令" aria-hidden="true">#</a> 1.用你最喜欢的编辑器来敲命令</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>command &lt;CTRL-x CTRL-e&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在已经敲完的命令后按 <code>&lt;CTRL-x CTRL-e&gt;</code>，会打开一个你指定的编辑器（比如vim，通过环境变量$EDITOR指定），里面就是你刚输入的命令，然后爱怎么编辑就怎么编辑吧，特别是那些参数异常复杂的程序，比如mencoder/ffmpeg，一个命令动辄3、4行的，要修改其中的参数，这个方法最合适不过了，保存退出后自动执行这个程序。</p><p>实际上这是<a href="http://tiswww.case.edu/php/chet/readline/rltop.html" target="_blank" rel="noopener noreferrer">readline库<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>的功能，在默认情况下，bash使用的是emacs模式的命令行操作方式，<code>&lt;CTRL-x CTRL-e&gt;</code> 是调用这个功能的一个绑定。如果你习惯使用vi模式，按 <code>&lt;ESC v&gt;</code> 可以实现同样功能。</p><p>如果你喜欢别的编辑器，可以在~/.bashrc里面放上比如export EDITOR=nano的命令。</p><p>另外一个修改命令的方法是使用fc命令（Fix Command），在编辑器里面打开上一句命令。我们的<a href="http://www.isspy.com/most_useful_linux_commands_1/" target="_blank" rel="noopener noreferrer">第一辑连载<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>提过一个^foo^bar^命令可以用fc来实现：fc -s foo=bar。</p><h2 id="_2-清空或创建一个文件" tabindex="-1"><a class="header-anchor" href="#_2-清空或创建一个文件" aria-hidden="true">#</a> 2.清空或创建一个文件</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&gt;</span> file.txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>&gt;</code> 在shell里面是标准输出重定向符，即把（前部个命令的）命令行输出转往一个文件内，但这里没有“前部命令”，输出为空，于是就覆盖（或创建）成一个空文件了。</p><p>有些脚本的写法是:&gt;file.txt，因为:是bash默认存在的空函数。</p><p>单纯创建文件也可以用$touch file.txt，touch本来是用作修改文件的时间戳，但如果文件不存在，就自动创建了。</p><h2 id="_3-用ssh创建端口转发通道" tabindex="-1"><a class="header-anchor" href="#_3-用ssh创建端口转发通道" aria-hidden="true">#</a> 3.用ssh创建端口转发通道</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ssh</span> <span class="token parameter variable">-N</span> -L2001:remotehost:80 user@somemachine
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这个命令在本机打开了2001端口，对本机2001端口的请求通过somemachine作为跳板，转到remotehost的80端口上。</p><p>实现效果跟术语反向代理是相似的，实际上就是端口转发，注意上面的描述涉及了3台主机，但当然somemachine可以变成localhost。</p><p>这个命令比较抽象，但有时候是很有用的，比如因为众所周知的原因国内的IP的80端口无法使用，又或者公司的防火墙只给外网开了ssh端口，需要访问内部服务器一个web应用，以及需要访问某些限定了来源IP的服务，就可以用上这个方法了。</p><p>举一个具体例子，运行：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ssh -f -N -L 0.0.0.0:443:twitter.com:443 shell.cjb.net ssh -f -N -L 0.0.0.0:80:twitter.com:80 shell.cjb.net
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后在/etc/hosts里面添加127.0.0.1 twitter.com，好吧剩下的你懂的。</p><p>当然通常做这个功能的反向代理，应该要用squid、nginx之类，ssh就算是轻量级的尝试吧！</p><h2 id="_4-重置终端" tabindex="-1"><a class="header-anchor" href="#_4-重置终端" aria-hidden="true">#</a> 4.重置终端</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>reset
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果你试过不小心cat了某个二进制文件，很可能整个终端就傻掉了，可能不会换行，没法回显，大堆乱码之类的，这时候敲入reset回车，不管命令有没有显示，就能回复正常了。</p><p>实际上reset命令只是输出了一些特殊字符，我们看BusyBox里面最简单的reset程序的实现：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>printf(“\033c\033(K\033[J\033[0m\033[?25h”);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>输出的这些字符对Shell是有特殊意义的：</p><p>· \033c: “ESC c” – 发送重置命令;</p><p>· \033(K: “ESC ( K” – 重载终端的字符映射;</p><p>· \033[J: “ESC [ J” – 清空终端内容;</p><p>· \033[0m: “ESC [ 0 m” – 初始化字符显示属性;</p><p>· \033[?25h: “ESC [ ? 25 h” – 让光标可见;</p><p>其中<em>字符显示属性</em>经常用来设定打印字符的颜色等，可参考<a href="http://linuxshellaccount.blogspot.com/2008/03/using-color-in-linux-or-unix-shell.html" target="_blank" rel="noopener noreferrer">这个博文<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h2 id="_5-在午夜的时候执行某命令" tabindex="-1"><a class="header-anchor" href="#_5-在午夜的时候执行某命令" aria-hidden="true">#</a> 5.在午夜的时候执行某命令</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>echo cmd | at midnight
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>说的就是at这个组件，通常跟cron相提并论，不过at主要用于定时一次性任务，而cron定时周期性任务。</p><p>at的参数比较人性化，跟英语语法一样，可以tomorrow, next week之类的，详细的查看手册man at。</p><h2 id="_6-远程传送麦克风语音" tabindex="-1"><a class="header-anchor" href="#_6-远程传送麦克风语音" aria-hidden="true">#</a> 6.远程传送麦克风语音</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dd if=/dev/dsp | ssh username@host dd of=/dev/dsp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>没错就是实现一个喊话器的功能。</p><p>/dev/dsp是Linux下声卡的文件映射（Digital Signal Proccessor），从其中读数据就是录音，往里面写数据就是播放，相当简单！</p><p>dd是常用的数据拷贝程序，如果不同时指定if、of，就直接使用stdin/stdout来传输。</p><p>如果你没有远程主机，可以试试这样：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dd if=/dev/dsp of=/dev/dsp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>直接回放麦克风的声音，只是有一点延时。</p><p>但是如果有别的程序正在使用声卡，这个方法就不凑效了，因为一般的声卡都不允许多个音频流同时处理，可以借用alsa组件的工具，arecord跟aplay:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>arecord | ssh username@host aplay
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>本地回放就是：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>arecord | aplay
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果你想吓吓别人：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>cat /dev/urandom | ssh username@host aplay
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_7-映射一个内存目录" tabindex="-1"><a class="header-anchor" href="#_7-映射一个内存目录" aria-hidden="true">#</a> 7.映射一个内存目录</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mount -t tmpfs -o size=1024m tmpfs /mnt/ram
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这个命令开了一块1G内存来当目录用。不过放心，如果里面没文件，是不会占用内存的，用多少占多少。</p><p>不过一般来说没必要手动挂载，因为多数发行版都会在fstab内预留了一个内存目录，挂载在/dev/shm，直接使用即可；</p><p>最常见的用途是用内存空间来放Firefox的配置，可以让慢吞吞的FF快很多，参见Shellex的博文：<a href="http://shellex.info/speeding-up-firefox-with-tmpfs/" target="_blank" rel="noopener noreferrer">用tmpfs让Firefox在内存中飞驰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，以及后来的改进：<a href="http://shellex.info/speeding-up-firefox-with-tmpfs-ii/" target="_blank" rel="noopener noreferrer">用tmpfs让Firefox在内存中飞驰II<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，其中提到的脚本来自<a href="http://www.linuxized.com/2009/05/speeding-up-firefox-with-tmpfs-and-automatic-rsync/" target="_blank" rel="noopener noreferrer">speeding up firefox with tmpfs and automatic rsync<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><p>那个破烂LinuxQQ也可以用这个方法，减少因为大量磁盘IO导致的问题。</p><h2 id="_8-用diff对比远程文件跟本地文件" tabindex="-1"><a class="header-anchor" href="#_8-用diff对比远程文件跟本地文件" aria-hidden="true">#</a> 8.用diff对比远程文件跟本地文件</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ssh user@host cat /path/to/remotefile | diff /path/to/localfile -
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>diff通常的用法是从参数读入两个文件，而命令里面的-则是指从stdin读入了。</p><p>善用ssh可以让web开发减少很多繁琐，还有比如sshfs，可以从<strong>编辑****-<strong><strong>上传</strong></strong>-<strong><strong>编辑</strong></strong>-****上传</strong>的人工循环里面解脱出来。</p><h2 id="_9-查看系统中占用端口的进程" tabindex="-1"><a class="header-anchor" href="#_9-查看系统中占用端口的进程" aria-hidden="true">#</a> 9.查看系统中占用端口的进程</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>netstat -tulnp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Netstat是很常用的用来查看Linux网络系统的工具之一，这个参数可以背下来：</p><p>· -t: 显示TCP链接信息</p><p>· -u: 显示UDP链接信息</p><p>· -l: 显示监听状态的端口</p><p>· -n: 直接显示ip，不做名称转换</p><p>· -p: 显示相应的进程PID以及名称（要root权限）</p><p>如果要查看关于sockets更详细占用信息等，可以使用lsof工具。</p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/emerywan/ubuntu-workstation-guide/edit/main/docs/tip/top_linux_commands.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/ubuntu-workstation-guide/tip/github.html" class="" aria-label="Github 国内加速"><!--[--><!--]--> Github 国内加速 <!--[--><!--]--></a></span><span class="next"><a href="/ubuntu-workstation-guide/tip/resourse.html" class="" aria-label="130个资源网站，总有一个你用得着"><!--[--><!--]--> 130个资源网站，总有一个你用得着 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/ubuntu-workstation-guide/assets/app-8c5101d9.js" defer></script>
  </body>
</html>
